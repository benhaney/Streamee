server {
  listen 443;
  ssl on;
  server_name stream.yourdomain.com;

  add_header Content-Security-Policy "default-src 'self'; media-src 'self' blob:; worker-src 'self' blob:;";

  location / {
    proxy_pass http://localhost:9030;
  }

  # WebSocket for chat server
  location /chat-socket/ {
    proxy_pass http://localhost:9031;
    proxy_http_version 1.1;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection "Upgrade";
  }
}
